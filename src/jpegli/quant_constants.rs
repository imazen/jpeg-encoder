// Quantization constants ported from quant.cc to jpegli::quant_constants::
//
// Naming convention mapping (Old C++ -> New Rust):
// kGlobalScaleXYB        -> GLOBAL_SCALE_XYB
// kGlobalScaleYCbCr      -> GLOBAL_SCALE_YCBCR
// kBaseQuantMatrixXYB    -> BASE_QUANT_MATRIX_XYB     (Size: 192 = 3 * 64)
// kBaseQuantMatrixYCbCr  -> BASE_QUANT_MATRIX_YCBCR   (Size: 192 = 3 * 64)
// k420GlobalScale        -> GLOBAL_SCALE_420
// k420Rescale            -> RESCALE_420               (Size: 64)
// kBaseQuantMatrixStd    -> BASE_QUANT_MATRIX_STD     (Size: 128 = 2 * 64)
// kZeroBiasMulYCbCrLQ    -> ZERO_BIAS_MUL_YCBCR_LQ    (Size: 192 = 3 * 64)
// kZeroBiasMulYCbCrHQ    -> ZERO_BIAS_MUL_YCBCR_HQ    (Size: 192 = 3 * 64)
// kZeroBiasOffsetYCbCrDC -> ZERO_BIAS_OFFSET_YCBCR_DC (Size: 3)
// kZeroBiasOffsetYCbCrAC -> ZERO_BIAS_OFFSET_YCBCR_AC (Size: 3)
// kTransferFunctionPQ    -> TRANSFER_FUNCTION_PQ
// kTransferFunctionHLG   -> TRANSFER_FUNCTION_HLG
// kExponent             -> EXPONENT (Size: 64)
// kDist0                -> DIST0
//
// For arrays of size 192 (BASE_QUANT_MATRIX_XYB, BASE_QUANT_MATRIX_YCBCR,
// ZERO_BIAS_MUL_YCBCR_LQ, ZERO_BIAS_MUL_YCBCR_HQ):
// - Indices 0..63   correspond to component c = 0 (e.g., Y or X)
// - Indices 64..127 correspond to component c = 1 (e.g., Cb or B)
// - Indices 128..191 correspond to component c = 2 (e.g., Cr or Y)
//
// For arrays of size 128 (BASE_QUANT_MATRIX_STD):
// - Indices 0..63   correspond to component c = 0 (Luma)
// - Indices 64..127 correspond to component c = 1 (Chroma)
//
// We're porting these to rust from C++
// Global scale is chosen in a way that butteraugli 3-norm matches libjpeg
// with the same quality setting. Fitted for quality 90 on jyrki31 corpus.
pub(crate) const GLOBAL_SCALE_XYB: f32 = 1.43951668;
pub(crate) const GLOBAL_SCALE_YCBCR: f32 = 1.73966010;

pub(crate) const BASE_QUANT_MATRIX_XYB: [f32; 192] = [
    // c = 0
    7.5629935265,
    19.8247814178,
    22.5724945068,
    20.6706695557,
    22.6864585876,
    23.5696277618,
    25.8129081726,
    36.3307571411,
    19.8247814178,
    21.5503177643,
    19.9372234344,
    20.5424213409,
    21.8645496368,
    23.9041385651,
    28.2844066620,
    32.6609764099,
    22.5724945068,
    19.9372234344,
    21.9017257690,
    19.1223449707,
    21.7515811920,
    24.6724700928,
    25.4249649048,
    32.6653823853,
    20.6706695557,
    20.5424213409,
    19.1223449707,
    20.1610221863,
    25.3719692230,
    25.9668903351,
    30.9804954529,
    31.3406009674,
    22.6864585876,
    21.8645496368,
    21.7515811920,
    25.3719692230,
    26.2431850433,
    40.5992202759,
    43.2624626160,
    63.3010940552,
    23.5696277618,
    23.9041385651,
    24.6724700928,
    25.9668903351,
    40.5992202759,
    48.3026771545,
    34.0964355469,
    61.9852142334,
    25.8129081726,
    28.2844066620,
    25.4249649048,
    30.9804954529,
    43.2624626160,
    34.0964355469,
    34.4937438965,
    66.9702758789,
    36.3307571411,
    32.6609764099,
    32.6653823853,
    31.3406009674,
    63.3010940552,
    61.9852142334,
    66.9702758789,
    39.9652709961,
    // c = 1
    1.6262000799,
    3.2199242115,
    3.4903779030,
    3.9148359299,
    4.8337211609,
    4.9108843803,
    5.3137121201,
    6.1676793098,
    3.2199242115,
    3.4547898769,
    3.6036829948,
    4.2652835846,
    4.8368387222,
    4.8226222992,
    5.6120514870,
    6.3431472778,
    3.4903779030,
    3.6036829948,
    3.9044559002,
    4.3374395370,
    4.8435096741,
    5.4057979584,
    5.6066360474,
    6.1075134277,
    3.9148359299,
    4.2652835846,
    4.3374395370,
    4.6064834595,
    5.1751475334,
    5.4013924599,
    6.0399808884,
    6.7825231552,
    4.8337211609,
    4.8368387222,
    4.8435096741,
    5.1751475334,
    5.3748049736,
    6.1410837173,
    7.6529307365,
    7.5235214233,
    4.9108843803,
    4.8226222992,
    5.4057979584,
    5.4013924599,
    6.1410837173,
    6.3431472778,
    7.1083049774,
    7.6008300781,
    5.3137121201,
    5.6120514870,
    5.6066360474,
    6.0399808884,
    7.6529307365,
    7.1083049774,
    7.0943155289,
    7.0478363037,
    6.1676793098,
    6.3431472778,
    6.1075134277,
    6.7825231552,
    7.5235214233,
    7.6008300781,
    7.0478363037,
    6.9186143875,
    // c = 2
    3.3038473129,
    10.0689258575,
    12.2785224915,
    14.6041173935,
    16.2107315063,
    19.2314529419,
    28.0129547119,
    55.6682891846,
    10.0689258575,
    11.4085016251,
    11.3871345520,
    15.4934167862,
    16.5364933014,
    14.9153423309,
    26.3748722076,
    40.8614425659,
    12.2785224915,
    11.3871345520,
    17.0886878967,
    13.9500350952,
    16.0003223419,
    28.5660629272,
    26.2124195099,
    30.1260128021,
    14.6041173935,
    15.4934167862,
    13.9500350952,
    21.1235027313,
    26.1579780579,
    25.5579223633,
    40.6859359741,
    33.8056335449,
    16.2107315063,
    16.5364933014,
    16.0003223419,
    26.1579780579,
    26.8042831421,
    26.1587715149,
    35.7343978882,
    43.6857032776,
    19.2314529419,
    14.9153423309,
    28.5660629272,
    25.5579223633,
    26.1587715149,
    34.5418128967,
    41.3197937012,
    48.7867660522,
    28.0129547119,
    26.3748722076,
    26.2124195099,
    40.6859359741,
    35.7343978882,
    41.3197937012,
    47.6329460144,
    55.3498458862,
    55.6682891846,
    40.8614425659,
    30.1260128021,
    33.8056335449,
    43.6857032776,
    48.7867660522,
    55.3498458862,
    63.6065597534,
];

pub(crate) const BASE_QUANT_MATRIX_YCBCR: [f32; 192] = [
    // c = 0
    1.2397409345866273,  //
    1.7227115097630963,  //
    2.9212167156636855,  //
    2.812737435286529,   //
    3.339819711906184,   //
    3.463603762596166,   //
    3.840915217993518,   //
    3.86956,             //
    1.7227115097630963,  //
    2.0928894413636874,  //
    2.8456760904429297,  //
    2.704506820909662,   //
    3.4407673520905337,  //
    3.166232352090534,   //
    4.025208741558432,   //
    4.035324490952577,   //
    2.9212167156636855,  //
    2.8456760904429297,  //
    2.9587403520905338,  //
    3.3862948970669273,  //
    3.619523781336757,   //
    3.9046279999999998,  //
    3.757835838431854,   //
    4.237447515714274,   //
    2.812737435286529,   //
    2.704506820909662,   //
    3.3862948970669273,  //
    3.380058821812233,   //
    4.1679867415584315,  //
    4.805510627261856,   //
    4.784259,            //
    4.605934,            //
    3.339819711906184,   //
    3.4407673520905337,  //
    3.619523781336757,   //
    4.1679867415584315,  //
    4.579851258441568,   //
    4.923237,            //
    5.574107,            //
    5.48533336146308,    //
    3.463603762596166,   //
    3.166232352090534,   //
    3.9046279999999998,  //
    4.805510627261856,   //
    4.923237,            //
    5.43936,             //
    5.093895741558431,   //
    6.0872254423617225,  //
    3.840915217993518,   //
    4.025208741558432,   //
    3.757835838431854,   //
    4.784259,            //
    5.574107,            //
    5.093895741558431,   //
    5.438461,            //
    5.4037359493250845,  //
    3.86956,             //
    4.035324490952577,   //
    4.237447515714274,   //
    4.605934,            //
    5.48533336146308,    //
    6.0872254423617225,  //
    5.4037359493250845,  //
    4.37787101190424,
    // c = 1
    2.8236197786377537,  //
    6.495639358561486,   //
    9.310489207538302,   //
    10.64747864717083,   //
    11.07419143098738,   //
    17.146390223910462,  //
    18.463982229408998,  //
    29.087001644203088,  //
    6.495639358561486,   //
    8.890103846667353,   //
    8.976895794294748,   //
    13.666270550318826,  //
    16.547071905624193,  //
    16.63871382827686,   //
    26.778396930893695,  //
    21.33034294694781,   //
    9.310489207538302,   //
    8.976895794294748,   //
    11.08737706005991,   //
    18.20548239870446,   //
    19.752481654011646,  //
    23.985660533114896,  //
    102.6457378402362,   //
    24.450989,           //
    10.64747864717083,   //
    13.666270550318826,  //
    18.20548239870446,   //
    18.628012327860365,  //
    16.042509519487183,  //
    25.04918273242625,   //
    25.017140189353015,  //
    35.79788782635831,   //
    11.07419143098738,   //
    16.547071905624193,  //
    19.752481654011646,  //
    16.042509519487183,  //
    19.373482748612577,  //
    14.677529999999999,  //
    19.94695960400931,   //
    51.094112,           //
    17.146390223910462,  //
    16.63871382827686,   //
    23.985660533114896,  //
    25.04918273242625,   //
    14.677529999999999,  //
    31.320412426835304,  //
    46.357234000000005,  //
    67.48111451705412,   //
    18.463982229408998,  //
    26.778396930893695,  //
    102.6457378402362,   //
    25.017140189353015,  //
    19.94695960400931,   //
    46.357234000000005,  //
    61.315764694388044,  //
    88.34665293823721,   //
    29.087001644203088,  //
    21.33034294694781,   //
    24.450989,           //
    35.79788782635831,   //
    51.094112,           //
    67.48111451705412,   //
    88.34665293823721,   //
    112.16099098350989,
    // c = 2
    2.9217254961255255,  //
    4.497681013199305,   //
    7.356344520940414,   //
    6.583891506504051,   //
    8.535608740100237,   //
    8.799434353234647,   //
    9.188341534163023,   //
    9.482700481227672,   //
    4.497681013199305,   //
    6.309548851989123,   //
    7.024608962670982,   //
    7.156445324163424,   //
    8.049059218663244,   //
    7.0124290657218555,  //
    6.711923184393611,   //
    8.380307846134853,   //
    7.356344520940414,   //
    7.024608962670982,   //
    6.892101177327445,   //
    6.882819916277163,   //
    8.782226090078568,   //
    6.8774750000000004,  //
    7.8858175969577955,  //
    8.67909,             //
    6.583891506504051,   //
    7.156445324163424,   //
    6.882819916277163,   //
    7.003072944847055,   //
    7.7223464701024875,  //
    7.955425720217421,   //
    7.4734110000000005,  //
    8.362933242943903,   //
    8.535608740100237,   //
    8.049059218663244,   //
    8.782226090078568,   //
    7.7223464701024875,  //
    6.778005927001542,   //
    9.484922741558432,   //
    9.043702663686046,   //
    8.053178199770173,   //
    8.799434353234647,   //
    7.0124290657218555,  //
    6.8774750000000004,  //
    7.955425720217421,   //
    9.484922741558432,   //
    8.607606527385098,   //
    9.922697394370815,   //
    64.25135180237939,   //
    9.188341534163023,   //
    6.711923184393611,   //
    7.8858175969577955,  //
    7.4734110000000005,  //
    9.043702663686046,   //
    9.922697394370815,   //
    63.184936549738225,  //
    83.35294340273799,   //
    9.482700481227672,   //
    8.380307846134853,   //
    8.67909,             //
    8.362933242943903,   //
    8.053178199770173,   //
    64.25135180237939,   //
    83.35294340273799,   //
    114.89202448569779,  //
];

pub(crate) const GLOBAL_SCALE_420: f32 = 1.22;
pub(crate) const RESCALE_420: [f32; 64] = [
    0.4093, 0.3209, 0.3477, 0.3333, 0.3144, 0.2823, 0.3214, 0.3354,  //
    0.3209, 0.3111, 0.3489, 0.2801, 0.3059, 0.3119, 0.4135, 0.3445,  //
    0.3477, 0.3489, 0.3586, 0.3257, 0.2727, 0.3754, 0.3369, 0.3484,  //
    0.3333, 0.2801, 0.3257, 0.3020, 0.3515, 0.3410, 0.3971, 0.3839,  //
    0.3144, 0.3059, 0.2727, 0.3515, 0.3105, 0.3397, 0.2716, 0.3836,  //
    0.2823, 0.3119, 0.3754, 0.3410, 0.3397, 0.3212, 0.3203, 0.0726,  //
    0.3214, 0.4135, 0.3369, 0.3971, 0.2716, 0.3203, 0.0798, 0.0553,  //
    0.3354, 0.3445, 0.3484, 0.3839, 0.3836, 0.0726, 0.0553, 0.3368,  //
];

pub(crate) const BASE_QUANT_MATRIX_STD: [f32; 128] = [
    // c = 0
    16.0, 11.0, 10.0, 16.0, 24.0, 40.0, 51.0, 61.0,      //
    12.0, 12.0, 14.0, 19.0, 26.0, 58.0, 60.0, 55.0,      //
    14.0, 13.0, 16.0, 24.0, 40.0, 57.0, 69.0, 56.0,      //
    14.0, 17.0, 22.0, 29.0, 51.0, 87.0, 80.0, 62.0,      //
    18.0, 22.0, 37.0, 56.0, 68.0, 109.0, 103.0, 77.0,    //
    24.0, 35.0, 55.0, 64.0, 81.0, 104.0, 113.0, 92.0,    //
    49.0, 64.0, 78.0, 87.0, 103.0, 121.0, 120.0, 101.0,  //
    72.0, 92.0, 95.0, 98.0, 112.0, 100.0, 103.0, 99.0,   //
    // c = 1
    17.0, 18.0, 24.0, 47.0, 99.0, 99.0, 99.0, 99.0,  //
    18.0, 21.0, 26.0, 66.0, 99.0, 99.0, 99.0, 99.0,  //
    24.0, 26.0, 56.0, 99.0, 99.0, 99.0, 99.0, 99.0,  //
    47.0, 66.0, 99.0, 99.0, 99.0, 99.0, 99.0, 99.0,  //
    99.0, 99.0, 99.0, 99.0, 99.0, 99.0, 99.0, 99.0,  //
    99.0, 99.0, 99.0, 99.0, 99.0, 99.0, 99.0, 99.0,  //
    99.0, 99.0, 99.0, 99.0, 99.0, 99.0, 99.0, 99.0,  //
    99.0, 99.0, 99.0, 99.0, 99.0, 99.0, 99.0, 99.0,  //
];

pub(crate) const ZERO_BIAS_MUL_YCBCR_LQ: [f32; 192] = [
    // c = 0
    0.0000, 0.0568, 0.3880, 0.6190, 0.6190, 0.4490, 0.4490, 0.6187,  //
    0.0568, 0.5829, 0.6189, 0.6190, 0.6190, 0.7190, 0.6190, 0.6189,  //
    0.3880, 0.6189, 0.6190, 0.6190, 0.6190, 0.6190, 0.6187, 0.6100,  //
    0.6190, 0.6190, 0.6190, 0.6190, 0.5890, 0.3839, 0.7160, 0.6190,  //
    0.6190, 0.6190, 0.6190, 0.5890, 0.6190, 0.3880, 0.5860, 0.4790,  //
    0.4490, 0.7190, 0.6190, 0.3839, 0.3880, 0.6190, 0.6190, 0.6190,  //
    0.4490, 0.6190, 0.6187, 0.7160, 0.5860, 0.6190, 0.6204, 0.6190,  //
    0.6187, 0.6189, 0.6100, 0.6190, 0.4790, 0.6190, 0.6190, 0.3480,  //
    // c = 1
    0.0000, 1.1640, 0.9373, 1.1319, 0.8016, 0.9136, 1.1530, 0.9430,  //
    1.1640, 0.9188, 0.9160, 1.1980, 1.1830, 0.9758, 0.9430, 0.9430,  //
    0.9373, 0.9160, 0.8430, 1.1720, 0.7083, 0.9430, 0.9430, 0.9430,  //
    1.1319, 1.1980, 1.1720, 1.1490, 0.8547, 0.9430, 0.9430, 0.9430,  //
    0.8016, 1.1830, 0.7083, 0.8547, 0.9430, 0.9430, 0.9430, 0.9430,  //
    0.9136, 0.9758, 0.9430, 0.9430, 0.9430, 0.9430, 0.9430, 0.9430,  //
    1.1530, 0.9430, 0.9430, 0.9430, 0.9430, 0.9430, 0.9430, 0.9480,  //
    0.9430, 0.9430, 0.9430, 0.9430, 0.9430, 0.9430, 0.9480, 0.9430,  //
    // c = 2
    0.0000, 1.3190, 0.4308, 0.4460, 0.0661, 0.0660, 0.2660, 0.2960,  //
    1.3190, 0.3280, 0.3093, 0.0750, 0.0505, 0.1594, 0.3060, 0.2113,  //
    0.4308, 0.3093, 0.3060, 0.1182, 0.0500, 0.3060, 0.3915, 0.2426,  //
    0.4460, 0.0750, 0.1182, 0.0512, 0.0500, 0.2130, 0.3930, 0.1590,  //
    0.0661, 0.0505, 0.0500, 0.0500, 0.3055, 0.3360, 0.5148, 0.5403,  //
    0.0660, 0.1594, 0.3060, 0.2130, 0.3360, 0.5060, 0.5874, 0.3060,  //
    0.2660, 0.3060, 0.3915, 0.3930, 0.5148, 0.5874, 0.3060, 0.3060,  //
    0.2960, 0.2113, 0.2426, 0.1590, 0.5403, 0.3060, 0.3060, 0.3060,  //
];

pub(crate) const ZERO_BIAS_MUL_YCBCR_HQ: [f32; 192] = [
    // c = 0
    0.0000, 0.0044, 0.2521, 0.6547, 0.8161, 0.6130, 0.8841, 0.8155,  //
    0.0044, 0.6831, 0.6553, 0.6295, 0.7848, 0.7843, 0.8474, 0.7836,  //
    0.2521, 0.6553, 0.7834, 0.7829, 0.8161, 0.8072, 0.7743, 0.9242,  //
    0.6547, 0.6295, 0.7829, 0.8654, 0.7829, 0.6986, 0.7818, 0.7726,  //
    0.8161, 0.7848, 0.8161, 0.7829, 0.7471, 0.7827, 0.7843, 0.7653,  //
    0.6130, 0.7843, 0.8072, 0.6986, 0.7827, 0.7848, 0.9508, 0.7653,  //
    0.8841, 0.8474, 0.7743, 0.7818, 0.7843, 0.9508, 0.7839, 0.8437,  //
    0.8155, 0.7836, 0.9242, 0.7726, 0.7653, 0.7653, 0.8437, 0.7819,  //
    // c = 1
    0.0000, 1.0816, 1.0556, 1.2876, 1.1554, 1.1567, 1.8851, 0.5488,  //
    1.0816, 1.1537, 1.1850, 1.0712, 1.1671, 2.0719, 1.0544, 1.4764,  //
    1.0556, 1.1850, 1.2870, 1.1981, 1.8181, 1.2618, 1.0564, 1.1191,  //
    1.2876, 1.0712, 1.1981, 1.4753, 2.0609, 1.0564, 1.2645, 1.0564,  //
    1.1554, 1.1671, 1.8181, 2.0609, 0.7324, 1.1163, 0.8464, 1.0564,  //
    1.1567, 2.0719, 1.2618, 1.0564, 1.1163, 1.0040, 1.0564, 1.0564,  //
    1.8851, 1.0544, 1.0564, 1.2645, 0.8464, 1.0564, 1.0564, 1.0564,  //
    0.5488, 1.4764, 1.1191, 1.0564, 1.0564, 1.0564, 1.0564, 1.0564,  //
    // c = 2
    0.0000, 0.5392, 0.6659, 0.8968, 0.6829, 0.6328, 0.5802, 0.4836,  //
    0.5392, 0.6746, 0.6760, 0.6102, 0.6015, 0.6958, 0.7327, 0.4897,  //
    0.6659, 0.6760, 0.6957, 0.6543, 0.4396, 0.6330, 0.7081, 0.2583,  //
    0.8968, 0.6102, 0.6543, 0.5913, 0.6457, 0.5828, 0.5139, 0.3565,  //
    0.6829, 0.6015, 0.4396, 0.6457, 0.5633, 0.4263, 0.6371, 0.5949,  //
    0.6328, 0.6958, 0.6330, 0.5828, 0.4263, 0.2847, 0.2909, 0.6629,  //
    0.5802, 0.7327, 0.7081, 0.5139, 0.6371, 0.2909, 0.6644, 0.6644,  //
    0.4836, 0.4897, 0.2583, 0.3565, 0.5949, 0.6629, 0.6644, 0.6644,  //
];

pub(crate) const ZERO_BIAS_OFFSET_YCBCR_DC: [f32; 3] = [0.0, 0.0, 0.0];

pub(crate) const ZERO_BIAS_OFFSET_YCBCR_AC: [f32; 3] = [
    0.59082,
    0.58146,
    0.57988,
];

pub(crate) const TRANSFER_FUNCTION_PQ: u8 = 16;
pub(crate) const TRANSFER_FUNCTION_HLG: u8 = 18;


pub(crate) const EXPONENT: [f32; 64] = [
    1.00, 0.51, 0.67, 0.74, 1.00, 1.00, 1.00, 1.00,  //
    0.51, 0.66, 0.69, 0.87, 1.00, 1.00, 1.00, 1.00,  //
    0.67, 0.69, 0.84, 0.83, 0.96, 1.00, 1.00, 1.00,  //
    0.74, 0.87, 0.83, 1.00, 1.00, 0.91, 0.91, 1.00,  //
    1.00, 1.00, 0.96, 1.00, 1.00, 1.00, 1.00, 1.00,  //
    1.00, 1.00, 1.00, 0.91, 1.00, 1.00, 1.00, 1.00,  //
    1.00, 1.00, 1.00, 0.91, 1.00, 1.00, 1.00, 1.00,  //
    1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00,  //
];
pub(crate) const DIST0: f32 = 1.5;  // distance where non-linearity kicks in.
